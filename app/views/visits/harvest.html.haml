%section.panel
  %header
    %h1
      %i.icon-home.icon-large
      &nbsp&nbsp&nbspHouseholds
  .content
    .span12
    .span-one-third
      = image_tag('second_logo.jpg')
    #harvest_report
      %h2 Monthly Report
    .row
    #msm_id.span-one-third
      %h4 Agency ID: 590AD
      %h4 Report for: #{Date.today.strftime('%B %d, %Y')}
      = link_to 'Second Harvest', 'http://www.secondharvestmetrolina.org/'
      - @month = "#{Date.today.strftime('%B %Y')}"
      - @pmonth = "#{(Date.today - 1.month).strftime('%B')}"
      - @ppre_year = 2016
      - @three_year = 2015
      - @four_year = 2014
      %h4 Month #{@month}
      #h4 Previous Month #{@pmonth}
      #h4 By Month #


    #harvest_month
      %br
      -#= search_form_for @month do |f|
      -#  = f.label Select Month
      -#  = f.options_for_select(month_select)
      -#  = f.submit
      / = simple_form_for visit, html: { :class => 'form-inline' } do |f|
      / = f.input :visited_on, label: 'Report Month', collection: month_select, input_html: {class: 'span2'}
    .row
    .span11
    %h4 The number of different Households served during:  #{@ppre_month}, #{@prev_month} and #{@month} 
    - household_status_for(households.all) do |stats|
      .span11
        %table.table.table-bordered
          %thead
            %tr
              %th Month
              %th Total Number of Visits
              %th Total Number of Households
              %th Total Number of Neighbors
              -# - @h_month = visits.by_month(@month).select "DISTINCT(household_id)"
              -# - @household_ids = visits.by_month(@month).pluck(:household_id).uniq
              -# - @prev_month_ids = visits.by_month(@prev_month).pluck(:household_id).uniq
              %tbody
                %tr
                  %td= Date.today.strftime("%B")
                  %td= @visits.visits_current_month
                  %td= @visits.households_current_month_count
                  %td= @visits.neighbors_current_month
                %tr
                  %td= @pmonth
                  %td= @visits.visits_past_month
                  %td= @visits.households_past_month_count
                  %td= @visits.neighbors_past_month
    %br
    .row
    .span11
    %h4 The total number of Individuals served during: #{@month}
    - household_status_for(households.all) do |stats|
      .span11
        %table.table.table-bordered
          %thead
            %tr
              %th < 19
              %th Between 18 & 64
              %th Over 64
              %th Total Served
              %tbody
                %tr
                  -# %td=  @visits.young_neighbors_current_month
                  -# %td=  @visits.middle_neighbors_current_month
                  -# %td=  @visits.old_neighbors_current_month
                  -# %td=  @visits.neighbors_current_month
    .row
    %br
    .row
    .span11
    %h4 The total number of Individuals served during: #{@pmonth}
    - household_status_for(households.all) do |stats|
      .span11
        %table.table.table-bordered
          %thead
            %tr
              %th < 19
              %th Between 18 & 64
              %th Over 64
              %th Total Served
              %tbody
                %tr
                  -# %td=  @visits.young_neighbors_past_month
                  -# %td=  @visits.middle_neighbors_past_month
                  -# %td=  @visits.old_neighbors_past_month
                  -# %td=  @visits.neighbors_past_month
  .row
  
  %br

